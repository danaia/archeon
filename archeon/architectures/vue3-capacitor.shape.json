{
  "meta": {
    "id": "vue3-capacitor",
    "name": "Vue 3 + Capacitor (Near-Native Mobile)",
    "description": "Native mobile app using Vue 3 Composition API wrapped with Capacitor, offline-first, plugin-gated IO. No TypeScript required.",
    "version": "1.0.0",
    "tags": ["mobile", "capacitor", "vue3", "offline-first", "composition-api"]
  },

  "architecture": {
    "summary": "A mobile-first architecture that wraps a Vue 3 web app with Capacitor to deploy as native iOS and Android applications. Uses Vite for fast development and static build output for Capacitor compatibility.",
    "layers": [
      {
        "name": "UI Layer (CMP)",
        "description": "Vue 3 components using Composition API with script setup. Components are purely presentational. Components NEVER access native APIs, HTTP, or databases directly. They receive data via props and emit events upward.",
        "rules": ["No direct IO", "No Capacitor plugin imports", "No fetch/axios calls", "State comes from STO via composables", "Use script setup syntax"]
      },
      {
        "name": "State Layer (STO)", 
        "description": "Pinia stores that manage application state and orchestrate data flow. Stores call Services (SVC) for business logic but never call native plugins directly.",
        "rules": ["Single source of truth", "Calls SVC for async operations", "Never imports Capacitor plugins", "Use composition API"]
      },
      {
        "name": "Service Layer (SVC)",
        "description": "Business logic orchestrators that coordinate between Adapters and Plugins. Services know WHAT to do but delegate HOW to adapters/plugins.",
        "rules": ["Orchestrates adapters and plugins", "Contains business logic", "Returns promises"]
      },
      {
        "name": "Adapter Layer (ADP)",
        "description": "HTTP and cache boundary. All network requests go through adapters. Handles API calls, caching strategies, and offline queue.",
        "rules": ["Wraps fetch/axios", "Implements caching", "Handles offline queue"]
      },
      {
        "name": "Plugin Layer (PLUG)",
        "description": "Capacitor native plugin wrappers. Each plugin wrapper isolates a single native capability (camera, filesystem, etc). Handles permissions and platform differences.",
        "rules": ["One plugin per file", "Handles permissions", "Platform-specific fallbacks"]
      }
    ],
    "dataFlow": "CMP -> STO (Pinia) -> SVC -> (ADP | PLUG) -> Native/HTTP",
    "keyPrinciples": [
      "UI components are dumb - no business logic or IO",
      "State stores orchestrate but don't perform IO directly", 
      "Services coordinate adapters and plugins",
      "All native access goes through PLUG wrappers",
      "All HTTP access goes through ADP adapters",
      "Vite for blazing fast dev and build",
      "Script setup syntax for cleaner Vue code"
    ],
    "offlineStrategy": "Offline-first with local cache. SVC layer checks network status and routes to cache or HTTP. Queue operations when offline, sync when online.",
    "buildProcess": "Vite builds Vue app to static HTML/JS/CSS. Capacitor syncs this to native iOS/Android projects which embed it in a webview."
  },

  "defaultChain": "@v1 NED:system.ready => ARC:vue3-capacitor => OUT:installed",

  "stack": {
    "frontend": {
      "framework": "vue3",
      "version": "3.4.x",
      "language": "javascript",
      "buildTool": "vite",
      "runtime": "capacitor",
      "stateManager": "pinia",
      "styling": "tailwindcss",
      "componentSyntax": "script-setup"
    },
    "platform": {
      "wrapper": "capacitor",
      "targets": ["ios", "android"],
      "plugins": [
        "camera",
        "filesystem",
        "preferences",
        "push-notifications",
        "haptics",
        "device",
        "network"
      ]
    }
  },

  "directories": {
    "client": {
      "src": {
        "components": {},
        "features": {},
        "stores": {},
        "services": {},
        "adapters": {},
        "platform": {
          "plugins": {},
          "permissions": {}
        },
        "lib": {
          "http": {},
          "cache": {},
          "utils": {}
        },
        "types": {}
      },
      "public": {},
      "ios": {
        "_note": "Generated by Capacitor - native iOS project"
      },
      "android": {
        "_note": "Generated by Capacitor - native Android project"
      }
    }
  },

  "files": {
    "client/package.json": "{\n  \"name\": \"vue3-capacitor-app\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"vite build\",\n    \"preview\": \"vite preview\",\n    \"cap:sync\": \"npx cap sync\",\n    \"cap:open:ios\": \"npx cap open ios\",\n    \"cap:open:android\": \"npx cap open android\",\n    \"cap:run:ios\": \"npx cap run ios\",\n    \"cap:run:android\": \"npx cap run android\",\n    \"build:mobile\": \"vite build && npx cap sync\"\n  },\n  \"dependencies\": {\n    \"vue\": \"^3.4.0\",\n    \"pinia\": \"^2.1.0\",\n    \"@capacitor/core\": \"^6.0.0\",\n    \"@capacitor/camera\": \"^6.0.0\",\n    \"@capacitor/filesystem\": \"^6.0.0\",\n    \"@capacitor/preferences\": \"^6.0.0\",\n    \"@capacitor/push-notifications\": \"^6.0.0\",\n    \"@capacitor/haptics\": \"^6.0.0\",\n    \"@capacitor/device\": \"^6.0.0\",\n    \"@capacitor/network\": \"^6.0.0\"\n  },\n  \"devDependencies\": {\n    \"@vitejs/plugin-vue\": \"^4.5.0\",\n    \"vite\": \"^5.0.0\",\n    \"tailwindcss\": \"^3.4.0\",\n    \"postcss\": \"^8.4.0\",\n    \"autoprefixer\": \"^10.4.0\",\n    \"@capacitor/cli\": \"^6.0.0\",\n    \"@capacitor/ios\": \"^6.0.0\",\n    \"@capacitor/android\": \"^6.0.0\"\n  }\n}",
    "client/vite.config.js": "import { defineConfig } from 'vite';\nimport vue from '@vitejs/plugin-vue';\nimport { fileURLToPath, URL } from 'node:url';\n\nexport default defineConfig({\n  plugins: [vue()],\n  resolve: {\n    alias: {\n      '@': fileURLToPath(new URL('./src', import.meta.url))\n    }\n  },\n  build: {\n    outDir: 'dist',\n    emptyOutDir: true,\n    sourcemap: false\n  },\n  server: {\n    middlewareMode: false\n  }\n});",
    "client/index.html": "<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, viewport-fit=cover\" />\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"default\" />\n  <title>Vue 3 Capacitor App</title>\n</head>\n<body>\n  <div id=\"app\"></div>\n  <script type=\"module\" src=\"/src/main.js\"></script>\n</body>\n</html>",
    "client/capacitor.config.ts": "import type { CapacitorConfig } from '@capacitor/cli';\n\nconst config: CapacitorConfig = {\n  appId: 'com.example.app',\n  appName: 'Vue Capacitor App',\n  webDir: 'dist',\n  server: {\n    androidScheme: 'https'\n  },\n  plugins: {\n    PushNotifications: {\n      presentationOptions: ['badge', 'sound', 'alert']\n    },\n    SplashScreen: {\n      launchShowDuration: 2000,\n      backgroundColor: '#ffffff',\n      showSpinner: false\n    }\n  }\n};\n\nexport default config;",
    "client/tailwind.config.js": "export default {\n  content: [\n    './index.html',\n    './src/**/*.{vue,js}'\n  ],\n  theme: {\n    extend: {\n      spacing: {\n        'safe-top': 'env(safe-area-inset-top)',\n        'safe-bottom': 'env(safe-area-inset-bottom)',\n        'safe-left': 'env(safe-area-inset-left)',\n        'safe-right': 'env(safe-area-inset-right)'\n      }\n    }\n  },\n  plugins: []\n};",
    "client/postcss.config.js": "export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {}\n  }\n};",
    "client/src/main.js": "import { createApp } from 'vue';\nimport { createPinia } from 'pinia';\nimport App from './App.vue';\nimport './style.css';\n\nconst app = createApp(App);\napp.use(createPinia());\napp.mount('#app');",
    "client/src/App.vue": "<script setup>\nimport { onMounted } from 'vue';\nimport { useAppStore } from '@/stores/app';\n\nconst appStore = useAppStore();\n\nonMounted(() => {\n  appStore.init();\n});\n</script>\n\n<template>\n  <div class=\"min-h-screen pt-safe-top pb-safe-bottom px-safe-left pr-safe-right bg-white dark:bg-slate-950\">\n    <header class=\"p-4 border-b border-slate-200 dark:border-slate-800\">\n      <h1 class=\"text-2xl font-bold\">Vue 3 Capacitor</h1>\n    </header>\n    <main class=\"p-4\">\n      <p class=\"text-gray-600 dark:text-gray-400\">\n        Edit src/App.vue to get started\n      </p>\n    </main>\n  </div>\n</template>\n\n<style scoped>\n</style>",
    "client/src/style.css": "@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  color-scheme: light dark;\n  color: rgba(255, 255, 255, 0.87);\n  background-color: #242424;\n}\n\n@media (prefers-color-scheme: light) {\n  :root {\n    color: #213547;\n    background-color: #ffffff;\n  }\n}\n\nbody {\n  margin: 0;\n  padding: 0;\n  overflow-x: hidden;\n  overscroll-behavior: none;\n  -webkit-overflow-scrolling: touch;\n  -webkit-user-select: none;\n  user-select: none;\n}\n\na {\n  font-weight: 500;\n  color: #646cff;\n  text-decoration: inherit;\n}\n\na:hover {\n  color: #535bf2;\n}\n\n#app {\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n}",
    "client/src/stores/app.js": "// @archeon:file\n// @glyph STO:App\n// @intent Application-wide store for initialization and global state\n\nimport { defineStore } from 'pinia';\nimport { ref, computed } from 'vue';\nimport { isNative, platform } from '@/platform/plugins/capacitor';\n\nexport const useAppStore = defineStore('app', () => {\n  const initialized = ref(false);\n  const isOnline = ref(true);\n  const platformType = ref(platform);\n\n  const isMobile = computed(() => isNative);\n\n  const init = async () => {\n    // Initialize app on first load\n    initialized.value = true;\n  };\n\n  return {\n    initialized,\n    isOnline,\n    platformType,\n    isMobile,\n    init\n  };\n});",
    "client/src/platform/plugins/capacitor.js": "// @archeon:file\n// @glyph PLUG:Capacitor\n// @intent Capacitor platform detection and initialization\n\nimport { Capacitor } from '@capacitor/core';\n\nexport const isNative = Capacitor.isNativePlatform();\nexport const platform = Capacitor.getPlatform(); // 'ios' | 'android' | 'web'\n\nexport function isIOS() {\n  return platform === 'ios';\n}\n\nexport function isAndroid() {\n  return platform === 'android';\n}\n\nexport function isWeb() {\n  return platform === 'web';\n}",
    "client/src/platform/plugins/network.js": "// @archeon:file\n// @glyph PLUG:Network\n// @intent Network status detection for offline-first support\n\nimport { Network } from '@capacitor/network';\n\nlet currentStatus = null;\n\nexport async function getNetworkStatus() {\n  if (currentStatus) return currentStatus;\n  currentStatus = await Network.getStatus();\n  return currentStatus;\n}\n\nexport async function isOnline() {\n  const status = await getNetworkStatus();\n  return status.connected;\n}\n\nexport function onNetworkChange(callback) {\n  const listener = Network.addListener('networkStatusChange', (status) => {\n    currentStatus = status;\n    callback(status);\n  });\n  \n  return () => listener.remove();\n}",
    "client/src/lib/utils.js": "// @archeon:file\n// @glyph FNC:classNameUtils\n// @intent Utility functions for class name composition\n\nexport function cn(...inputs) {\n  return inputs\n    .filter(Boolean)\n    .join(' ')\n    .split(' ')\n    .filter((item, i, arr) => arr.indexOf(item) === i)\n    .join(' ');\n}"
  },

  "glyphs": {
    "CMP": {
      "description": "Vue 3 component using script setup syntax (UI only, no IO)",
      "layer": "frontend",
      "output": {
        "directory": "client/src/components",
        "extension": ".vue",
        "naming": "PascalCase"
      },
      "sections": ["script-setup", "template", "style"],
      "snippet": "<!-- @archeon:file\n     @glyph {GLYPH_NAME}\n     @intent {INTENT}\n     @chain {CHAIN}\n-->\n\n<script setup>\nimport { ref, computed } from 'vue';\n\n// @archeon:section script-setup\ndefineProps({\n  {PROPS}\n});\n\ndefineEmits([\n  {EMITS}\n]);\n\n{STATE}\n\n{COMPUTED}\n// @archeon:endsection\n</script>\n\n<template>\n  <!-- @archeon:section template -->\n  <div class=\"{CLASSES}\">\n    {CONTENT}\n  </div>\n  <!-- @archeon:endsection -->\n</template>\n\n<!-- @archeon:section style -->\n<style scoped>\n{STYLES}\n</style>\n<!-- @archeon:endsection -->",
      "placeholders": {
        "GLYPH_NAME": { "required": true },
        "INTENT": { "default": "UI Component" },
        "CHAIN": { "default": "@v1" },
        "PROPS": { "default": "" },
        "EMITS": { "default": "" },
        "STATE": { "default": "" },
        "COMPUTED": { "default": "" },
        "CLASSES": { "default": "" },
        "CONTENT": { "default": "" },
        "STYLES": { "default": "" }
      }
    },

    "STO": {
      "description": "Pinia store using Composition API",
      "layer": "frontend",
      "output": {
        "directory": "client/src/stores",
        "extension": ".js",
        "naming": "camelCase"
      },
      "sections": ["imports", "store-definition"],
      "snippet": "// @archeon:file\n// @glyph {GLYPH_NAME}\n// @intent {INTENT}\n// @chain {CHAIN}\n\nimport { defineStore } from 'pinia';\nimport { ref, computed } from 'vue';\n\n// @archeon:section imports\n{IMPORTS}\n// @archeon:endsection\n\nexport const use{NAME}Store = defineStore('{STORE_ID}', () => {\n  // @archeon:section store-definition\n  {STATE}\n\n  {COMPUTED}\n\n  {ACTIONS}\n\n  return {\n    {RETURNS}\n  };\n  // @archeon:endsection\n});",
      "placeholders": {
        "GLYPH_NAME": { "required": true },
        "NAME": { "required": true },
        "STORE_ID": { "required": true },
        "INTENT": { "default": "Store" },
        "CHAIN": { "default": "@v1" },
        "IMPORTS": { "default": "" },
        "STATE": { "default": "" },
        "COMPUTED": { "default": "" },
        "ACTIONS": { "default": "" },
        "RETURNS": { "default": "" }
      }
    },

    "SVC": {
      "description": "Service / use-case orchestrator",
      "layer": "frontend",
      "output": {
        "directory": "client/src/services",
        "extension": ".js",
        "naming": "camelCase"
      },
      "sections": ["imports", "service"],
      "snippet": "// @archeon:file\n// @glyph {GLYPH_NAME}\n// @intent {INTENT}\n\n// @archeon:section imports\n{IMPORTS}\n// @archeon:endsection\n\n// @archeon:section service\nexport async function {FUNCTION_NAME}() {\n  {IMPLEMENTATION}\n}\n// @archeon:endsection",
      "placeholders": {
        "GLYPH_NAME": { "required": true },
        "FUNCTION_NAME": { "required": true },
        "INTENT": { "default": "Service" },
        "IMPORTS": { "default": "" },
        "IMPLEMENTATION": { "default": "" }
      }
    },

    "ADP": {
      "description": "Adapter (HTTP / cache boundary)",
      "layer": "frontend",
      "output": {
        "directory": "client/src/adapters",
        "extension": ".js",
        "naming": "camelCase"
      },
      "sections": ["imports", "adapter"],
      "snippet": "// @archeon:file\n// @glyph {GLYPH_NAME}\n\n// @archeon:section imports\n{IMPORTS}\n// @archeon:endsection\n\n// @archeon:section adapter\nexport const {NAME}Adapter = {\n  async fetch() {\n    {IMPLEMENTATION}\n  }\n};\n// @archeon:endsection",
      "placeholders": {
        "GLYPH_NAME": { "required": true },
        "NAME": { "required": true },
        "IMPORTS": { "default": "" },
        "IMPLEMENTATION": { "default": "" }
      }
    },

    "PLUG": {
      "description": "Capacitor plugin wrapper",
      "layer": "frontend",
      "output": {
        "directory": "client/src/platform/plugins",
        "extension": ".js",
        "naming": "camelCase"
      },
      "sections": ["imports", "plugin"],
      "snippet": "// @archeon:file\n// @glyph {GLYPH_NAME}\n\n// @archeon:section imports\n{IMPORTS}\n// @archeon:endsection\n\n// @archeon:section plugin\nexport async function {FUNCTION_NAME}() {\n  {IMPLEMENTATION}\n}\n// @archeon:endsection",
      "placeholders": {
        "GLYPH_NAME": { "required": true },
        "FUNCTION_NAME": { "required": true },
        "IMPORTS": { "default": "" },
        "IMPLEMENTATION": { "default": "" }
      }
    }
  },

  "constraints": {
    "forbidden": [
      "CMP -> ADP",
      "CMP -> PLUG",
      "CMP -> HTTP",
      "CMP -> DB",
      "STO -> PLUG",
      "CMP -> SVC"
    ]
  },

  "dependencies": {
    "client": {
      "vue": "^3.4.0",
      "pinia": "^2.1.0",
      "@capacitor/core": "^6.0.0",
      "@capacitor/camera": "^6.0.0",
      "@capacitor/filesystem": "^6.0.0",
      "@capacitor/preferences": "^6.0.0",
      "@capacitor/push-notifications": "^6.0.0",
      "@capacitor/haptics": "^6.0.0",
      "@capacitor/device": "^6.0.0",
      "@capacitor/network": "^6.0.0"
    },
    "devDependencies": {
      "@vitejs/plugin-vue": "^4.5.0",
      "vite": "^5.0.0",
      "tailwindcss": "^3.4.0",
      "postcss": "^8.4.0",
      "autoprefixer": "^10.4.0",
      "@capacitor/cli": "^6.0.0",
      "@capacitor/ios": "^6.0.0",
      "@capacitor/android": "^6.0.0"
    }
  },

  "setup": {
    "commands": [
      "npm install",
      "npx cap init {PROJECT_NAME} com.{PROJECT_NAME}.app --web-dir=dist",
      "npx cap add ios",
      "npx cap add android",
      "npm run build",
      "npx cap sync"
    ],
    "notes": [
      "Vite builds to dist/ folder - capacitor.config.ts is configured with webDir: 'dist'",
      "Run 'npm run dev' for hot-reload development",
      "Run 'npm run build:mobile' to build and sync in one command",
      "Run 'npx cap open ios' to open Xcode project",
      "Run 'npx cap open android' to open Android Studio project",
      "iOS requires Xcode and CocoaPods installed",
      "Android requires Android Studio with SDK tools",
      "No TypeScript required - pure JavaScript with Composition API"
    ]
  }
}
